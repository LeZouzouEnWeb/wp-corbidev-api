name: ðŸš€ DÃ©ploiement PROD

on:
  pull_request:
    types: [closed]
    branches:
      - main

permissions:
  contents: write
  pull-requests: write

jobs:
  deploy-prod:
    name: ðŸš€ DÃ©ploiement PROD
    if: github.event.pull_request.merged == true
    uses: LeZouzouEnWeb/workflows/.github/workflows/deploy.yml@V1.0.5
    permissions:
      contents: write
      pull-requests: write
    secrets:
      # Secrets requis pour le dÃ©ploiement SSH
      REMOTE_CHEMIN: ${{ secrets.REMOTE_CHEMIN }}        # Chemin de base sur le serveur
      SFTP_HOST: ${{ secrets.SFTP_HOST }}                # Adresse du serveur
      SFTP_USER: ${{ secrets.SFTP_USER }}                # Utilisateur SSH
      SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}    # ClÃ© privÃ©e SSH
    with:
      # Variables pour construire le chemin distant
      ADRESSE_GLOBAL: ${{ vars.ADRESSE_GLOBAL }}         # Ex: www
      ADRESSE_LOCAL: ${{ vars.ADRESSE_LOCAL }}           # Ex: mon-site
      remote_env: 'prod'
      PATH_ORDER: 'local-env'
      enable_mirror: false